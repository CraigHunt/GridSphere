<!--

<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
  "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">

    Author:     Jason Novotny
    Version:    $Id$
-->

<chapter id="portlet-lifecycle">
    <title>Portlet Lifecycle</title>


<para>
The portlet lifecycle extends the servlet lifecycle by offering more control over the event processing required of a
and the presentation rendering. Just as servlets have <methodname>init</methodname> and
<methodname>destroy</methodname> methods, the  portlet lifecycle methods listed below are responsible for the initialization and
shutdown of concrete and application portlets. For every request made by a user, the <methodname>service</methodname> method is
invoked which is responsible for invoking the appropriate <link linkend='portlet-action'>portlet action method</link>
if one exists followed by the appropriate <link linkend='portlet-render'>portlet render method</link> for all portlets
that are currently displayed on the portal page. All lifecycle methods throw a &PortletException; which acts as a proxy
for the standard &ServletException;.
</para>

<itemizedlist>
<listitem><para>
    Application portlet initialization is the first phase of startup. The portlet is
    instantiated with the &PortletConfig; information described in
    <link linkend='portlet-objects' endterm="portlet-objects-title"/>
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>init</methodname>(PortletConfig <emphasis>config</emphasis>)
    </programlisting>
</para></listitem>
<listitem><para>
    The concrete portlet is placed into service and parametrized with a &PortletSettings; object described in
    <link linkend='portlet-objects' endterm="portlet-objects-title"/>
    <programlisting>
    <prompt>void</prompt> <methodname>initConcrete</methodname>(PortletSettings <emphasis>settings</emphasis>)
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>service</methodname> method is invoked for every client request. Based on the portlet mode or portlet action,
    it invokes the appropriate action method if there is one followed by the render method of all displayed portlets.
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>service</methodname>(PortletRequest <emphasis>req</emphasis>, PortletResponse <emphasis>res</emphasis>)
    </programlisting>
</para></listitem>

<listitem><para>
    The concrete portlet is taken out of service either dynamically when a portlet web application is unloaded or
    when the portal is shutdown
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>destroyConcrete</methodname>()
    </programlisting>
</para></listitem>
<listitem><para>
    The application portlet is taken out of service either dynamically when a portlet web application is unloaded or
    when the portal is shutdown
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>destroy</methodname>()
    </programlisting>
</para></listitem>

</itemizedlist>

<sect1><title id="portlet-action">Portlet Action Methods</title>
    <para>
        The Action methods handle any events that a portlet may have triggered. Any kind of form or hyperlink
        triggered event will cause the <methodname>actionPerformed</methodname> method to be executed. Other
        events included window events when a portlet is minimized, maximized, or resized and message events
        when a portlet has received a message from another portlet. The &ActionEvent;, &WindowEvent; and &MessageEvent;
        objects that get passed into the corresponding action methods contain the &PortletRequest; and &PortletResponse;
        objects.
    </para>
<itemizedlist>
<listitem><para>
    The <methodname>actionPerformed</methodname> method is invoked when the portlet receives an action and must be
    implemented by the portlet developer. This method is performed before any rendering is done via doView,
    doEdit, etc.
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>actionPerformed</methodname>(ActionEvent <emphasis>event</emphasis>)
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>messageReceived</methodname> method is invoked when the portlet receives a message.
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>messageReceived</methodname>(MessageEvent <emphasis>event</emphasis>)
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>windowMaximized</methodname> method is invoked for a portlet when the portlet window is maximized.
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>windowMaximized</methodname>(WindowEvent <emphasis>event</emphasis>)
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>windowMinimized</methodname> method is invoked for a portlet when the portlet window is minimized.
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>windowMinimized</methodname>(WindowEvent <emphasis>event</emphasis>)
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>windowResized</methodname> method is invoked for a portlet when the portlet window is resized.
    </para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>windowResized</methodname>(WindowEvent <emphasis>event</emphasis>)
    </programlisting>
</para></listitem>


</itemizedlist>
</sect1>

<sect1>
    <title id="portlet-render">Portlet Render Methods</title>
    <para>
    The portlet container will render portlet presentation for all portlets that are currently visible in the page
    based on the mode they are in as described previously. A portlet developer can override these methods to
    provide customized layout by either printing to the output stream of the &PortletResponse; directly or by using a
    &PortletContext; to perform an <methodname>include</methodname> on a chosen resource e.g. HTML or a JSP. The
    <methodname>doTitle</methodname> is invoked by the layout engine during portlet rendering. If
    <methodname>doTitle</methodname> is not overriden, then the title obtained from the concrete portlet desfinition is
    used.
    </para>
<itemizedlist>
<listitem><para>
    The <methodname>doView</methodname> method is invoked for a portlet when it is in <emphasis>VIEW</emphasis> mode.
</para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>doView</methodname>(PortletRequest <emphasis>req</emphasis>,PortletResponse <emphasis>res</emphasis> )
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>doEdit</methodname> method is invoked for a portlet when it is in <emphasis>EDIT</emphasis> mode.
</para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>doEdit</methodname>(PortletRequest <emphasis>req</emphasis>,PortletResponse <emphasis>res</emphasis> )
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>doConfigure</methodname> method is invoked for a portlet when it is in <emphasis>CONFIGURE</emphasis> mode.
    This mode is allowed only for portlet administrators and is intended to provide additional portlet configuration.
</para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>doEdit</methodname>(PortletRequest <emphasis>req</emphasis>,PortletResponse <emphasis>res</emphasis> )
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>doHelp</methodname> method is invoked for a portlet when it is in <emphasis>HELP</emphasis> mode.
</para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>doHelp</methodname>(PortletRequest <emphasis>req</emphasis>,PortletResponse <emphasis>res</emphasis> )
    </programlisting>
</para></listitem>

<listitem><para>
    The <methodname>doTitle</methodname> method is invoked for a portlet during its rendering by the layout engine and can be
    implemented by a portlet developer to provide a customized title.
</para><para>
    <programlisting>
    <prompt>void</prompt> <methodname>doTitle</methodname>(PortletRequest <emphasis>req</emphasis>,PortletResponse <emphasis>res</emphasis> )
    </programlisting>
</para></listitem>

</itemizedlist>

</sect1>
</chapter>